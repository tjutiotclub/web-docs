# 高维数据 —— 数组（Array）

当程序中只处理单个变量时，基础数据类型已经足够。  
但在工程实践中，我们往往需要处理：

- 一组传感器数据
- 一段连续采样
- 一张表格
- 一个空间网格

数组（Array）用于表示**同类型数据的有序集合**，是最基础的高维数据结构。

---

## 什么是数组

数组的本质是：

> **在内存中连续存放的一组同类型数据**

数组中的每个元素：
- 类型相同
- 大小相同
- 通过索引访问

---

## 一维数组（1D Array）

### 基本定义形式

```c
int data[10];
````

表示一个包含 10 个 `int` 类型元素的数组。

---

### 一维数组的工程语义

一维数组常用于表示：

* 连续采样数据
* 缓冲区
* 表格的一行
* 固定数量的对象集合

---

### 访问方式

```c
data[0] = 5;
data[3] = 10;
```

⚠️ 数组下标从 **0** 开始。

---

### 内存视角

一维数组在内存中是**完全连续的**：

```text
data[0] | data[1] | data[2] | ... | data[9]
```

这使得数组非常适合：

* DMA
* 通信缓存
* 高效遍历

---

## 一维数组与循环的结合

```c
for (int i = 0; i < 10; i++)
{
    data[i] = i * 2;
}
```

工程语义是：

> **对一组数据执行相同操作**

这是循环最常见、最合理的使用方式之一。

---

## 二维数组（2D Array）

### 基本定义形式

```c
int matrix[3][4];
```

表示一个 **3 行 4 列** 的二维数组。

---

### 二维数组的工程语义

二维数组常用于表示：

* 表格数据
* 矩阵
* 图像（行 × 列）
* 地图或棋盘

可以理解为：

> **“数组的数组”**

---

### 访问方式

```c
matrix[0][0] = 1;
matrix[2][3] = 5;
```

---

### 二维数组的内存布局（重要）

尽管逻辑上是“行 × 列”，
**在内存中依然是线性连续存放的**（按行优先）：

```text
matrix[0][0], matrix[0][1], ..., matrix[0][3],
matrix[1][0], matrix[1][1], ..., matrix[1][3],
matrix[2][0], ...
```

这对以下场景非常关键：

* 指针访问
* DMA 传输
* 图像缓存

---

### 二维数组与嵌套循环

```c
for (int i = 0; i < 3; i++)
{
    for (int j = 0; j < 4; j++)
    {
        matrix[i][j] = i + j;
    }
}
```

工程语义是：

> **在二维空间内进行规则遍历**

---

## 三维数组（3D Array）

### 基本定义形式

```c
int cube[2][3][4];
```

表示一个 **2 × 3 × 4** 的三维数组。

---

### 三维数组的工程语义

三维数组常用于表示：

* 时间 × 行 × 列（时序数据）
* 空间体素数据
* 多通道数据
* 地图 + 时间维度

可以理解为：

> **“二维数组在第三个维度上的扩展”**

---

### 访问方式

```c
cube[1][2][3] = 10;
```

---

### 三维数组的内存顺序

逻辑上是三维，
但在内存中依然是**一维线性展开**：

```text
cube[0][0][0] ... cube[0][0][3]
cube[0][1][0] ...
...
cube[1][2][3]
```

**最右侧下标变化最快**。

---

### 三维数组与三重循环

```c
for (int i = 0; i < 2; i++)
{
    for (int j = 0; j < 3; j++)
    {
        for (int k = 0; k < 4; k++)
        {
            cube[i][j][k] = i + j + k;
        }
    }
}
```

工程语义是：

> **对高维数据空间进行系统性扫描**

---

## 数组使用中的工程限制

1. 数组大小在编译期确定（静态数组）
2. 下标越界不会自动报错
3. 数组占用连续内存，过大可能导致栈溢出
4. 多维数组可读性随维度上升而下降

---

## 数组与数据类型的关系

数组的每一个维度，都基于**确定的数据类型**：

```c
uint16_t adc_buffer[128];
float image[480][640];
```

类型选择直接决定：

* 内存占用
* 精度
* 运算效率

---

## 常见工程误区

1. 混淆“数组大小”和“数组下标最大值”
2. 忘记数组下标从 0 开始
3. 使用数组但不配合循环
4. 误以为多维数组在内存中是“真正多维”

---

## 小结

* 数组是**同类型数据的连续集合**
* 多维数组在逻辑上升维，在内存中始终一维
* 循环是数组的天然搭档
* 数组是通向结构体、缓冲区、矩阵和图像的基础
